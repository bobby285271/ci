<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0"
xmlns:content="http://purl.org/rss/1.0/modules/content/"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
xmlns:atom="http://www.w3.org/2005/Atom"
xmlns:wfw="http://wellformedweb.org/CommentAPI/">
<channel>
<title>Dasyatis - Ubuntu</title>
<link>https://static.bobby285271.top/index.php/tag/Ubuntu/</link>
<atom:link href="https://static.bobby285271.top/index.php/feed/tag/Ubuntu/" rel="self" type="application/rss+xml" />
<language>zh-CN</language>
<description></description>
<lastBuildDate>Fri, 04 Oct 2019 16:00:00 +0000</lastBuildDate>
<pubDate>Fri, 04 Oct 2019 16:00:00 +0000</pubDate>
<item>
<title>How to Launch a Desktop Environment on WSL 2</title>
<link>https://static.bobby285271.top/index.php/2019/10/05/How-to-Launch-a-Desktop-Environment-on-WSL-2.html</link>
<guid>https://static.bobby285271.top/index.php/2019/10/05/How-to-Launch-a-Desktop-Environment-on-WSL-2.html</guid>
<pubDate>Fri, 04 Oct 2019 16:00:00 +0000</pubDate>
<dc:creator>Bobby Rong</dc:creator>
<description><![CDATA[WSL 2 是 WSL 中体系结构的新版本，它改变了 Linux 发行版与 Windows 交互的方式。WSL 2 的主要目标是提高文件系统性能并增加系统调用的完全兼容性。 每个 Linux 发...]]></description>
<content:encoded xml:lang="zh-CN"><![CDATA[
<p>WSL 2 是 WSL 中体系结构的新版本，它改变了 Linux 发行版与 Windows 交互的方式。<br>WSL 2 的主要目标是提高文件系统性能并增加系统调用的完全兼容性。 每个 Linux 发行版都可以作为 WSL 1 或 WSL 2 发行版运行，并可随时进行切换。<br>WSL 2 是底层体系结构的主要功能，它使用虚拟化技术和 Linux 内核来实现其新功能。</p><h2>准备</h2><p>为了使用 WSL 2，你需要 <strong>Windows 10 内部版本 18917 或更高版本</strong>。要想了解目前使用的版本是什么，可以到设置页面查看。<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/0.PNG" alt="" title=""></p><p>首先，右击任务栏 Windows 图标，选择 Windows Powershell（管理员），输入以下命令：</p><pre><code>Enable-WindowsOptionalFeature -Online -FeatureName VirtualMachinePlatform
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</code></pre><p>或者前往控制面板 - 程序 - 启用或关闭 Windows 功能，然后勾选<strong>虚拟机平台</strong>和<strong>执行 Linux 程序的 Windows 子系统</strong>。<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/" alt="" title=""></p><p>完成设置后需要重启计算机！</p><h2>安装</h2><p>前往 Microsoft Store 下载并安装 Ubuntu。<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/2.PNG" alt="" title=""></p><p>接下来使 WSL 2 成为你的默认体系结构。打开 Windows Powershell 或命令提示符：</p><pre><code>wsl --set-default-version 2</code></pre><p>接下来在开始菜单找到 Ubuntu，点击后稍作等候。当一切准备好后，Ubuntu 会提示你新建一个账户和密码，注意输入密码时是不会有回显的。<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/5.PNG" alt="" title=""></p><p>此时你可以验证刚刚安装好的 Ubuntu 所使用的 WSL 版本：</p><pre><code>wsl --list --verbose</code></pre><p><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/6.PNG" alt="" title=""></p><p>如果你在 Windows Powershell 或命令提示符下运行 <code>wsl</code>，同样也是可以进入 WSL 环境的。</p><h2>软件</h2><p>切换到 Root：</p><pre><code>$ sudo -i</code></pre><p>编辑 APT 软件源（<code>nano</code> 大法好，不接受反驳） ：</p><pre><code># nano /etc/apt/sources.list</code></pre><pre><code>deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse</code></pre><p>更新可用软件包列表，随后升级系统：</p><pre><code># apt update &amp;&amp; apt dist-upgrade -y</code></pre><p>安装基本开发环境、Xubuntu 桌面和远程桌面支持：</p><pre><code># apt install build-essential xubuntu-desktop xrdp</code></pre><p><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/11.PNG" alt="" title=""></p><p>安装的软件包比较多，可能要等上一段时间。这里的 Xubuntu 桌面实际为 XFCE 桌面环境，换成别的问题不大但还是建议选择轻量级桌面。</p><p>保存 Xsession 配置：</p><pre><code># exit #切换回普通用户。
$ echo xfce4-session &gt; ~/.xsession</code></pre><h2>远程桌面</h2><blockquote>需要使用远程桌面时均要执行本节内容。</blockquote><p>启用 Xrdp 服务（这里不能使用 <code>systemctl</code>，因为 SystemD 不是默认的 Init 系统），记录端口信息：</p><pre><code>$ sudo service xrdp start</code></pre><p>在 Windows 开始菜单栏中找到 Windows 附件 - 远程桌面连接，输入 <code>localhost:端口</code>，如 <code>localhost:3389</code>。</p><p>应该会出现如下警告，选择是即可：<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/16.PNG" alt="" title=""></p><p>如果你没有看到这个警告，可能需要查找虚拟机的 IP 地址并替代 <code>localhost</code> 再试一次：</p><pre><code>$ ip address</code></pre><p><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/13.PNG" alt="" title=""></p><p>在这里，IP 地址查找到是 <code>172.18.221.157</code>，端口是 <code>3389</code>。注意每次重启 WSL 实例后这个 IP 地址都会换。</p><p>输入 <code>IP 地址:端口</code>，如 <code>172.18.221.157:3389</code>。</p><p>接下来输入自己的账户密码：<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/17.PNG" alt="" title=""></p><p>然后就是很熟悉的界面了：<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/18.PNG" alt="" title=""></p><h2>本地化</h2><p>直接在终端下就可以完成设置了（以下命令在 Root 下运行）：</p><pre><code># dpkg-reconfigure locales</code></pre><p>确认 <code>en_US.UTF-8 UTF-8</code> 和 <code>zh_CN.UTF-8 UTF-8</code> 被勾选，然后将 <code>zh_CN.UTF-8 UTF-8</code> 设定为默认值。<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/19.PNG" alt="" title=""></p><p>然后安装语言包和输入法（按理来说装完就能用）：</p><pre><code># apt install language-pack-zh-hans language-pack-gnome-zh-hans fcitx fcitx-table</code></pre><h2>彩蛋</h2><p>Windows 应用能访问 Linux 根文件系统啦，包括文件资源管理器！尝试在 WSL 中使用普通用户运行 <code>explorer.exe .</code>（在远程桌面会话中这样做是没有用滴！），看看会发生什么。</p><p>另外内部错误大法又怎能缺席呢（逃）。<br><img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/wsl2/20.PNG" alt="" title=""></p>
]]></content:encoded>
<slash:comments>0</slash:comments>
<comments>https://static.bobby285271.top/index.php/2019/10/05/How-to-Launch-a-Desktop-Environment-on-WSL-2.html#comments</comments>
<wfw:commentRss>https://static.bobby285271.top/index.php/feed/2019/10/05/How-to-Launch-a-Desktop-Environment-on-WSL-2.html</wfw:commentRss>
</item>
</channel>
</rss>