
<!DOCTYPE HTML>
<html class="no-js bg" lang="zh-cmn-Hans">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<meta charset="UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">

<meta name="renderer" content="webkit">

<meta name="theme-color" content="#3a3f51" />
<meta http-equiv="x-dns-prefetch-control" content="on">
<title>How to Port Calamares to Arch Linux (en) - Dasyatis</title>
<link rel="icon" type="image/ico" href="https://bobby285271.coding.net/p/img/d/img/git/raw/master/favicon.ico">
<meta name="description" content="This article is for reference ONLY.Calamares is a distribution-independent installer framework. A..." />
<meta name="keywords" content="Arch Linux,Calamares,Python" />
<meta name="generator" content="Typecho 1.2/18.1.29" />
<meta name="template" content="handsome" />
<link rel="alternate" type="application/rss+xml" title="How to Port Calamares to Arch Linux (en) &raquo; Dasyatis &raquo; RSS 2.0" href="../../../feed/2020/02/18/How-to-Port-Calamares-to-Arch-Linux-en.html" />
<link rel="alternate" type="application/rdf+xml" title="How to Port Calamares to Arch Linux (en) &raquo; Dasyatis &raquo; RSS 1.0" href="../../../feed/rss/2020/02/18/How-to-Port-Calamares-to-Arch-Linux-en.html" />
<link rel="alternate" type="application/atom+xml" title="How to Port Calamares to Arch Linux (en) &raquo; Dasyatis &raquo; ATOM 1.0" href="../../../feed/atom/2020/02/18/How-to-Port-Calamares-to-Arch-Linux-en.html" />
<script type="text/x-mathjax-config">
        MathJax.Hub.Config({messageStyle: "none",tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
    </script>

<link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

<link rel="stylesheet" href="../../../../usr/themes/handsome/assets/css/function.min.css%3Fv=6.0.020191205.css" type="text/css" />
<link rel="stylesheet" href="../../../../usr/themes/handsome/assets/css/handsome.min.css%3Fv=6.0.020191205.css" type="text/css" />

<link rel="stylesheet" href="../../../../usr/themes/handsome/assets/css/features/jquery.fancybox.min.css%3Fv=6.0.020191205.css" type="text/css" />
<link rel="stylesheet" href="../../../../usr/themes/handsome/assets/css/features/code/vs.min.css%3Fv=6.0.020191205.css" type="text/css" />

<link rel="stylesheet" href="../../../../usr/themes/handsome/assets/css/font.min.css%3Fv=6.0.020191205.css" type="text/css" />
<style type="text/css">
        
        html.bg {
        background: #EFEFEF
        }
        .cool-transparent .off-screen+* .app-content-body {
        background: #EFEFEF
        }
@media (max-width:767px){
    html.bg {
        background: #EFEFEF
        }
        .cool-transparent .off-screen+* .app-content-body {
        background: #EFEFEF
        }
}
    </style>

<script src="https://cdn.staticfile.org/jquery/2.2.4/jquery.min.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>

<script src="../../../../usr/themes/handsome/assets/js/features/fancyMorph.min.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
</head>
<body id="body" class="fix-padding">

<div id="alllayout" class="app app-aside-fix container app-header-fixed "> 
<header id="header" class="fix-padding app-header navbar box-shadow-bottom-lg" role="menu">

<div class="text-ellipsis navbar-header bg-white">
<button class="pull-right visible-xs" ui-toggle-class="show animated animated-lento fadeIn" target=".navbar-collapse">
<span class="menu-icons"><i data-feather="search"></i></span>
</button>
<button class="pull-left visible-xs" ui-toggle-class="off-screen animated" target=".app-aside" ui-scroll="app">
<span class="menu-icons"><i data-feather="menu"></i></span>
</button>

<a href="../../../../index.html" class="navbar-brand text-lt">
<i class="fontello fontello-home"></i>
<span class="hidden-folded m-l-xs">Dasyatis</span>
</a>

</div>


<div class="collapse pos-rlt navbar-collapse bg-white">

<form id="searchform1" class="searchform navbar-form navbar-form-sm navbar-left shift" method="post" role="search">
<div class="form-group">
<div class="input-group rounded bg-white-pure box-shadow-wrap-normal">
<input autocomplete="off" id="search_input" type="search" name="s" class="transparent rounded form-control input-sm no-borders padder" required placeholder="输入关键词搜索…">

<ul id="search_tips_drop" class="small-scroll-bar dropdown-menu hide" style="display: block;top: 
                30px; left: 0px;">
</ul>
<span id="search_submit" class="transparent input-group-btn">
<button type="submit" class="transparent btn btn-sm">
<span class="feathericons" id="icon-search"><i data-feather="search"></i></span>
<span class="feathericons animate-spin  hide" id="spin-search"><i data-feather="loader"></i></span>


</button>
</span>
</div>
</div>
</form>
<a href="How-to-Port-Calamares-to-Arch-Linux-en.html" style="display: none" id="searchUrl"></a>

<ul class="nav navbar-nav navbar-right">

<li class="dropdown">
<a href="How-to-Port-Calamares-to-Arch-Linux-en.html#" data-toggle="dropdown" class="feathericons dropdown-toggle">
<i data-feather="twitch"></i>
<span class="visible-xs-inline">
闲言碎语 </span>
<span class="badge badge-sm up bg-danger pull-right-xs"></span>
</a>

<div class="dropdown-menu w-xl animated fadeInUp">
<div class="panel bg-white">
<div class="panel-heading b-light bg-light">
<strong>
闲言碎语 </strong>
</div>
<div class="list-group" id="smallRecording">
<a href="../../../cross.html" class="list-group-item"><span class="clear block m-b-none words_contents">GDM 使用的字体和 GNOME 使用的字体不一样就很烦躁，发现一个简单的解决方法。其实就是登录 gdm 用户然后用 gsettings 改字体，毕竟人家似乎也不管你的 /etc/fonts/local.conf。machinectl shell <span class="__cf_email__" data-cfemail="6700030a27">[email&#160;protected]</span> /bin/bashgsettings set org.gnome.desktop.interface font-name "Noto S...<br><small class="text-muted">2020-5-14 12:19:43</small></span></a> </div>
</div>
</div>
</li>


<li class="dropdown" id="easyLogin">
<a onclick="if (!window.__cfRLUnblockHandlers) return false; return false" data-toggle="dropdown" class="dropdown-toggle clear" data-toggle="dropdown" data-cf-modified-79619f1f7f80ee694fe4b856-="">
<span class="feathericons"><i data-feather="key"></i></span>
<b class="caret"></b>
</a>

<div class="dropdown-menu w-lg wrapper bg-white animated fadeIn" aria-labelledby="navbar-login-dropdown">
<form id="Login_form" action="https://static.bobby285271.top/index.php/action/login?_=7c78f74084b27fe12f428325e86aee9b" method="post">
<div class="form-group">
<label for="navbar-login-user">用户名</label>
<input type="text" name="name" id="navbar-login-user" class="form-control" placeholder="用户名或电子邮箱"></div>
<div class="form-group">
<label for="navbar-login-password">密码</label>
<input type="password" name="password" id="navbar-login-password" class="form-control" placeholder="密码"></div>
<button style="width: 100%" type="submit" id="login-submit" name="submitLogin" class="btn-rounded box-shadow-wrap-lg btn-gd-primary padder-lg">
<span>登录</span>
<span class="text-active">登录中...</span>
<span class="banLogin_text">刷新页面后登录</span>
<i class="animate-spin  fontello fontello-spinner hide" id="spin-login"></i>
<i class="animate-spin fontello fontello-refresh hide" id="ban-login"></i>
</button>
<input type="hidden" name="referer" value="https://static.bobby285271.top" data-current-url="value"></form>
</div>
</li>

</ul>
</div>

</header>


<aside id="aside" class="app-aside hidden-xs bg-white"> 
<div class="aside-wrap" layout="column">
<div class="navi-wrap scroll-y scroll-hide" flex>

<div class="clearfix hidden-xs text-center hide  show" id="aside-user">
<div class="dropdown wrapper vertical-wrapper">
<div ui-nav>
<a href="../../../About.html">
<span class="thumb-lg w-auto-folded avatar m-t-sm  vertical-avatar">
<img src="https://bobby285271.coding.net/p/img/d/img/git/raw/master/0782bea86d809777847ee49607ce2ce2_2_1_art.jpg" class="img-full img-circle normal-shadow">
</span>
</a>
</div>
<a href="How-to-Port-Calamares-to-Arch-Linux-en.html#" data-toggle="dropdown" class="dropdown-toggle hidden-folded  vertical-flex">
<span class="clear">
<span class="block m-t-sm">
<strong class="font-bold text-lt">Bobby Rong</strong>
<b class="caret"></b>
</span>
<span class="text-muted text-xs block">SCNUSE 学生</span>
</span>
</a>

<ul class="dropdown-menu animated fadeInRight w hidden-folded no-padder">
<li class="wrapper b-b m-b-sm bg-info m-n">
<span class="arrow top hidden-folded arrow-info"></span>
<div>
<p>晚上好，注意早点休息</p>
</div>
<div class="progress progress-xs m-b-none dker">
<div class="progress-bar bg-white" data-toggle="tooltip" data-original-title="时间已经度过95.83%" style="width: 95.83%"></div>
</div>
</li>
</ul>

</div>
</div>


<nav ui-nav class="navi clearfix">
<ul class="nav">

<div class="line dk hidden-folded"></div>
<li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
<span>导航</span>
</li>

<li>
<a href="../../../../index.html" class="auto">
<span class="nav-icon"><i data-feather="home"></i></span>
<span>首页</span>
</a>
</li>

<li> <a target="_blank" href="https://start.bobby285271.top/" class="auto"><span class="nav-icon"><i data-feather="command"></i></span><span>Start Page</span></a></li> <li class="line dk"></li>

<li class="hidden-folded padder m-t m-b-sm text-muted text-xs">
<span>组成</span>
</li>

<li>
<a class="auto">
<span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span>

<span class="nav-icon"><i data-feather="grid"></i></span>
<span>分类</span>
</a>
<ul class="nav nav-sub dk">
<li class="nav-sub-header">
<a>
<span>分类</span>
</a>
</li>

<li><a href="../../../category/Uncategorized/index.html"><b class="badge pull-right">0</b><span>Uncategorized</span></a></li><li><a href="../../../category/Linux-Distributions/index.html"><b class="badge pull-right">3</b><span>Linux Distributions</span></a></li><li><a href="../../../category/Algorithm-and-ACM/index.html"><b class="badge pull-right">6</b><span>Algorithm and ACM</span></a></li><li><a href="../../../category/Web-and-Internet/index.html"><b class="badge pull-right">2</b><span>Web and Internet</span></a></li><li><a href="../../../category/applications/index.html"><b class="badge pull-right">1</b><span>Desktop Applications</span></a></li> </ul>
</li>

<li>
<a class="auto">
<span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span>
<span class="nav-icon"><i data-feather="file"></i></span>
<span>页面</span>
</a>
<ul class="nav nav-sub dk">
<li class="nav-sub-header">
<a data-no-instant>
<span>页面</span>
</a>
</li>

<li><a href="../../../Studio.html"><span>Studio</span></a></li>
<li><a href="../../../archiso.html"><span>Archiso</span></a></li>
<li><a href="../../../About.html"><span>About</span></a></li>
<li><a href="../../../cross.html"><span>Cross</span></a></li>
<li><a href="../../../Archives.html"><span>Archives</span></a></li>
</ul>
</li>

<li>
<a class="auto">
<span class="pull-right text-muted">
<i class="fontello icon-fw fontello-angle-right text"></i>
<i class="fontello icon-fw fontello-angle-down text-active"></i>
</span>
<span class="nav-icon"><i data-feather="user"></i></span>
<span>友链</span>
</a>
<ul class="nav nav-sub dk">
<li class="nav-sub-header">
<a data-no-instant>
<span>友链</span>
</a>
</li>

<li data-original-title="在 Arch Linux 社区疯狂输出的大佬" data-toggle="tooltip" data-placement="top"><a href="https://felixc.at/" target="_blank"><span>Felix Yan</span></a></li><li data-original-title="早期的百度贴吧 Linux 吧大水怪" data-toggle="tooltip" data-placement="top"><a href="https://fiveyellowmice.com/" target="_blank"><span>FiveYellowMice</span></a></li><li data-original-title="SCNU ACMer，神犇" data-toggle="tooltip" data-placement="top"><a href="https://www.cnblogs.com/JNzH/" target="_blank"><span>JNzH</span></a></li><li data-original-title="GDUT ACMer，神犇" data-toggle="tooltip" data-placement="top"><a href="https://kaidora.github.io/" target="_blank"><span>Kaidora</span></a></li><li data-original-title="SCNU SE1905 同班同学" data-toggle="tooltip" data-placement="top"><a href="https://user-kay.github.io/" target="_blank"><span>Kay Chen</span></a></li><li data-original-title="0xFFFF.one 站长，大佬" data-toggle="tooltip" data-placement="top"><a href="https://izgq.net/" target="_blank"><span>ZGQ</span></a></li><li data-original-title="百度贴吧 Linux 吧魔法大吧" data-toggle="tooltip" data-placement="top"><a href="http://www.wenyinos.org/" target="_blank"><span>WenyinOS</span></a></li><li data-original-title="早期的百度贴吧 Linux 吧大水怪，北大学霸" data-toggle="tooltip" data-placement="top"><a href="https://lightmelodies.github.io/" target="_blank"><span>LightMelodies</span></a></li><li data-original-title="软协技术部锅长" data-toggle="tooltip" data-placement="top"><a href="https://mikyming.online/" target="_blank"><span>MikyMing</span></a></li><li data-original-title="百度贴吧 Linux 吧吧友" data-toggle="tooltip" data-placement="top"><a href="https://realasking.tk/" target="_blank"><span>Realasking</span></a></li> </ul>
</li>
</ul>
</nav>

</div>


<div id="left_footer" class="footer wrapper-xs text-center nav-xs lt">
<div class="col-xs-4 no-padder">
<a target="_blank" class="tinav" href="../../../../admin/index.html" title="" data-toggle="tooltip" data-placement="top" data-original-title="后台管理">
<span class="left-bottom-icons block"><i data-feather="settings"></i></span>
<small class="text-muted">管理</small>
</a>
</div>
<div class="col-xs-4 no-padder">
<a target="_blank" class="tinav" href="../../../feed/index.html" title="" data-toggle="tooltip" data-placement="top" data-original-title="文章RSS地址">
<span class="left-bottom-icons block"><i data-feather="rss"></i></span>
<small class="text-muted">文章</small>
</a>
</div>
<div class="col-xs-4 no-padder">
<a target="_blank" href="../../../feed/comments/index.html" title="" data-toggle="tooltip" data-placement="top" data-original-title="评论RSS地址">
<span class="left-bottom-icons block"><i data-feather="message-square"></i></span>
<small class="text-muted">评论</small>
</a>
</div>
</div>
</div>
</aside>

<div id="content" class="app-content">

<div id="loading" class="butterbar active hide">
<span class="bar"></span>
</div> 
<style>
    #post-content{
        font-size: 14px;
    }
</style>

<a class="off-screen-toggle hide"></a>
<main class="app-content-body ">
<div class="hbox hbox-auto-xs hbox-auto-sm">

<div class="col center-part">


<header id="small_widgets" class="bg-light lter wrapper-md">
<h1 class="entry-title m-n font-thin text-black l-h">How to Port Calamares to Arch Linux (en)<a class="plus-font-size" data-toggle="tooltip" data-original-title="点击改变文章字体大小"><i data-feather="type"></i></a><a data-morphing="" id="morphing" data-src="#morphing-content" href="javascript:;" class="read_mode superscript m-l-sm" data-toggle="tooltip" data-placement="right" data-original-title="阅读模式"><i data-feather="book-open"></i></a></h1> 
<ul class="entry-meta text-muted list-inline m-b-none small
             post-head-icon">

<li class="meta-author"><span class="post-icons"><i data-feather="user"></i></span><span class="sr-only">博主：</span> <a class="meta-value" href="../../../author/1/index.html" rel="author"> Bobby Rong</a></li>

<li class="meta-date"><span class="post-icons"><i data-feather="clock"></i></span><span class="sr-only">发布时间：</span><time class="meta-value">2020 年 02 月 18 日</time></li>

<li class="meta-views"><span class="post-icons"><i data-feather="eye"></i></span><span class="meta-value">176次浏览</span></li>

<li class="meta-comments"><span class="post-icons"><i data-feather="message-circle"></i></span><a class="meta-value" href="How-to-Port-Calamares-to-Arch-Linux-en.html#comments">暂无评论</a></li>

<li class="meta-word"><span class="post-icons"><i data-feather="pen-tool"></i></span><span class="meta-value">8965字数</span></li>

<li class="meta-categories"><span class="post-icons"><i data-feather="hash"></i></span><span class="sr-only">分类：</span> <span class="meta-value"><a href="../../../category/applications/index.html">Desktop Applications</a></span></li>
</ul>
</header>
<div class="wrapper-md" id="post-panel">
<ol class="breadcrumb bg-white-pure" itemscope=""><li>
<a href="../../../../index.html" itemprop="breadcrumb" title="返回首页" data-toggle="tooltip"><span class="home-icons"><i data-feather="home"></i></span>首页</a>
</li><li class="active">正文&nbsp;&nbsp;</li>
<div style="float:right;">
分享到：
<style>
   .breadcrumb i.iconfont.icon-qzone:after {
    padding: 0 0 0 5px;
    color: #ccc;
    content: "/\00a0";
    }
    
   </style>
<a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://static.bobby285271.top/index.php/2020/02/18/How-to-Port-Calamares-to-Arch-Linux-en.html&title=How to Port Calamares to Arch Linux (en)&site=https://static.bobby285271.top/" itemprop="breadcrumb" target="_blank" title="" data-toggle="tooltip" data-original-title="分享到QQ空间" onclick="if (!window.__cfRLUnblockHandlers) return false; window.open(this.href, 'qzone-share', 'width=550,height=335');return false;" data-cf-modified-79619f1f7f80ee694fe4b856-=""><i style="font-size:15px;" class="iconfont icon-qzone" aria-hidden="true"></i></a>
<a href="http://service.weibo.com/share/share.php?url=https://static.bobby285271.top/index.php/2020/02/18/How-to-Port-Calamares-to-Arch-Linux-en.html&title=How to Port Calamares to Arch Linux (en)" target="_blank" itemprop="breadcrumb" title="" data-toggle="tooltip" data-original-title="分享到微博" onclick="if (!window.__cfRLUnblockHandlers) return false; window.open(this.href, 'weibo-share', 'width=550,height=335');return false;" data-cf-modified-79619f1f7f80ee694fe4b856-=""><i style="font-size:15px;" class="fontello fontello-weibo" aria-hidden="true"></i></a></div></ol> 
<div id="postpage" class="blog-post">
<article class="single-post panel">

<div class="entry-thumbnail" aria-hidden="true"><div class="item-thumb lazy" data-original="https://static.bobby285271.top/usr/themes/handsome/usr/img/sj/7.jpg" style="background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAAA1JREFUCJljePfx038ACXMD0ZVlJAYAAAAASUVORK5CYII=)"></div></div> 
<div id="post-content" class="wrapper-lg">
<div class="entry-content l-h-2x">
<blockquote>This article is for reference ONLY.</blockquote><p>Calamares is a distribution-independent installer framework. As distributions like Arch Linux don't provide graphical installer, we can try to adapt Calamares to them. To make things easier, we simply start by trying to provide a <code>pacstrap</code> part for Calamares, which allow users to install a minimal Arch Linux system, then we add the Calamares installer to our Archiso.</p><h2>Getting Started</h2><p>Make sure that you have Git installed, fetch the source code by cloning the Calamares repository, to speed up, add <code>--depth=1</code> option:</p><pre><code>git clone https://github.com/calamares/calamares.git --depth=1
</code></pre><p>Entering the repository, you will find lots of files and directories, don't panic! All you have to focus on are three files/directories: <code>settings.conf</code>, <code>src/branding/</code> and <code>src/modules/</code>. Let's try to deal with them one by one.</p><h2>Step One: <code>settings.conf</code></h2><p>Firstly, you will find something like this:</p><pre><code>sequence:
- show:
  - welcome
  - locale
  - ...
- exec:
  - partition
  - mount
  - ...
- show:
  - finished
</code></pre><p>This is the installation process of Calamares, consisting of the <code>show</code> part and the <code>exec</code> part. Unlike Arch Linux's official install way where users DIY their system from the beginning to the end, users should setup their system in the <code>show</code> part and the <code>exec</code> part should handle the rest of the work then <code>show</code> again to inform user whether the installation work is succeed or not, which is considered more user-friendly. Each part (<code>show</code> and <code>exec</code>) includes several modules like <code>welcome</code>, <code>locale</code> and so on. We will talk about them later.</p><p>Now go to ArchWiki and have a look at the Installation Guide, you will find that some of the modules can be safely removed because when you perform a installation by following the ArchWiki, you never do such things like <code>plymouthcfg</code> (In fact, plymouth is not supported by Arch Linux at all). However, you will need to add some part because Calamares doesn't provide such option, such as a <code>pacstrap</code> part. Simply add the line <code>- pacstrap</code> and do rest of the thing later in step three.</p><pre><code>sequence:
- show:
  - welcome
  - locale
  - keyboard
  - partition
  - users
  - summary
- exec:
  - partition
  - mount
  - pacstrap
  - networkcfg
  - packages
  - machineid
  - fstab
  - locale
  - keyboard
  - localecfg
  - users
  - networkcfg
  - hwclock
  - bootloader
  - umount
- show:
  - finished
</code></pre><p>Let's move on. You will then see some of the boolean variables with notes above each of them. Simply set <code>true</code> or <code>false</code> according to the notes. Leave <code>branding</code> as <code>default</code>, you will configure it in step two.</p><h2>Step Two: <code>src/branding/</code></h2><p>In fact, this step is optional if you don't care about branding at all. The problem is that your users will be faced with something strange like the distro name <code>Fancy GNU/Linux 2020.2 LTS &quot;Turgid Tuba&quot;</code> and the slide show texted <code>This is a customizable QML slideshow.</code> So it is not recommend to skip this step if you want to distribute the Calamares and Archiso to others.</p><p>Navigate to the <code>src/branding/</code> directory, read the <code>README.md</code> carefully, and enter the <code>default/</code> directory. There are two files that you have to pay attention. One of them is <code>branding.desc</code>. These entries should be modified to the actual one:</p><pre><code>strings:
    productName:         &quot;@{NAME}&quot;
    shortProductName:    Arch Linux
    version:             Rolling
    shortVersion:        Rolling
    versionedName:       Arch Linux
    shortVersionedName:  Arch Linux
    bootloaderEntryName: Arch Linux
    productUrl:          https://www.archlinux.org/
    supportUrl:          https://bbs.archlinux.org/
    knownIssuesUrl:      https://bugs.archlinux.org/
    releaseNotesUrl:     https://www.archlinux.org/
</code></pre><p>Another one is <code>show.qml</code>. It is used to control slide shows. Here we only add one page, with the image <code>squid.png</code> (already included in the directory) and text <code>Arch Linux is a lightweight and flexible Linux distribution that tries to Keep It Simple.</code></p><pre><code>    Slide {

        Image {
            id: background
            source: &quot;squid.png&quot;
            width: 200; height: 200
            fillMode: Image.PreserveAspectFit
            anchors.centerIn: parent
        }
        Text {
            anchors.horizontalCenter: background.horizontalCenter
            anchors.top: background.bottom
            text: &quot;Arch Linux is a lightweight and flexible Linux distribution that tries to Keep It Simple.&quot;
            wrapMode: Text.WordWrap
            width: presentation.width
            horizontalAlignment: Text.Center
        }
    }
</code></pre><h2>Step Three: <code>src/modules/</code></h2><p>This is the most difficult part. You should do configurations for all modules listed in <code>settings.conf</code>. In most of the time, you don't have to do programming work, but simply edit the <code>*.conf</code> file. For example, if you want to edit the <code>users</code> module, open <code>src/modules/users.conf</code> and edit it. Here is a sample file:</p><pre><code>---
defaultGroups:
    - users
    - wheel

autologinGroup:  autologin
doAutologin:     true
setRootPassword: true
doReusePassword: true

passwordRequirements:
    nonempty: true
    minLength: -1
    maxLength: -1
    libpwquality:
        - minlen=0
        - minclass=0

allowWeakPasswords: false
allowWeakPasswordsDefault: false
</code></pre><p>For modules you created by yourself, like <code>pactrap</code>, you have to create a folder for it with the same name. Make sure you have already known a little bit about Python and Shell script, now start coding!</p><p>All we have to do is to call the real <code>pactrap</code> command. But it seems that if we really do that, the installation process may failed because of the behavior of Calamares. So we also have to port <code>pacstrap</code> for Calamares later. For now, we just name the script <code>pacstrap_calamares</code> and forget it. Let's create a file <code>main.py</code>.</p><pre><code>#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import subprocess
import libcalamares
from pathlib import Path

root_mount_point = libcalamares.globalstorage.value(&quot;rootMountPoint&quot;)
    
def run():
    &quot;&quot;&quot;
    Installing base filesystem. Please wait! It may take some time!
    &quot;&quot;&quot;

    PACSTRAP = &quot;/usr/bin/pacstrap_calamares&quot;
    PACKAGES = &quot;base grub efibootmgr linux linux-firmware vi nano networkmanager&quot;

    subprocess.call(PACSTRAP.split(' ') + [root_mount_point] + PACKAGES.split(' '))

</code></pre><p>In fact, <code>subprocess</code> can always be used to write Shell script in Python. The only thing you have do is to save command into a string <code>foo</code>, then split it using <code>foo.split(' ')</code>, and put it into <code>subprocess.call()</code>. Here, we call <code>/usr/bin/pacstrap_calamares</code> and ask it to install some basic package <code>base grub efibootmgr linux linux-firmware vi nano networkmanager</code>. When <code>pacstrap_calamares</code> is running, Calamares will show <code>Installing base filesystem. Please wait! It may take some time!</code> on the screen.</p><h2>Step Four: Build Calamares</h2><p>We can build Calamares when we are building Archiso so the build process won't make your system dirty. Assume that you already have a Archiso profile. First, we add the needed packages to <code>packages.x86_64</code>.</p><pre><code>kf5
qt5
boost
kpmcore
yaml-cpp
polkit-qt5
</code></pre><p>Assume that you have entered the chroot environment. To build Calamares, three steps are reqired: <code>cmake</code>, <code>make</code> and <code>make install</code>. Write all the steps down, and put it into <code>airootfs/root/</code>. Here is an example file:</p><pre><code>#/bin/bash
cd /root/
mkdir ./calamares/build/
cd ./calamares/build/
cmake ..
make
make install
mkdir /etc/calamares/
cp -p /root/archlinux-calamares/settings.conf /etc/calamares/
rm -rf /root/archlinux-calamares/ /root/calamares/ /root/build_calamares.sh
pacman -Rscun qt5-doc qt5-examples --noconfirm
</code></pre><p>Now we can ask <code>airootfs/root/customize_airootfs.sh</code> to run this shell script after a chroot environment is entered. Make sure the script is executable.</p><pre><code>cd /root
./build_calamares.sh
</code></pre><p>Almost done! Don't forget to create a <code>pacstrap_calamares</code> file for Calamares. Create a <code>airootfs/usr/bin/pacstrap_calamares</code> file. You don't have to worry about how to fill the file. Someone has already done that for you! And <span class="external-link"><a href="https://raw.githubusercontent.com/endeavouros-team/install-scripts/master/pacstrap_calamares" target="_blank">here is the file<i data-feather='external-link'></i></a></span>. Thanks for the work done by Endeavour OS team.</p> </div>

<div class="show-foot">
<div class="notebook">
<i class="fontello fontello-clock-o"></i>
<span>最后修改：2020 年 05 月 01 日 12 : 06 PM</span>
</div>
<div class="copyright" data-toggle="tooltip" data-html="true" data-original-title="转载请保留本文转载地址，著作权归作者所有"><span>© 允许规范转载</span>
</div>
</div>

</div>
</article>
</div>

<nav class="m-t-lg m-b-lg">
<ul class="pager">
<li class="next"> <a class="box-shadow-wrap-normal" href="../09/2020-Nowcoder-Basic-Algorithm-Training-Camp-Solutions.html" title="2020 Nowcoder Basic Algorithm Training Camp Solutions" data-toggle="tooltip">
下一篇 </a></li> <li class="previous"> <a class="box-shadow-wrap-normal" href="../../04/15/NixOS-Installation-and-Configuration-Guide.html" title="NixOS Installation and Configuration Guide" data-toggle="tooltip"> 上一篇 </a></li>
</ul>
</nav>

<style>
            textarea#comment{
                background-image: url('https://s2.ax1x.com/2019/07/20/ZzaGcV.png');
                background-color: #ffffff;
                transition: all 0.25s ease-in-out 0s;
            }
            textarea#comment:focus {
                background-position-y: 105px;
                transition: all 0.25s ease-in-out 0s;
            }
        </style>
<div id="comments">


<div id="respond-post-73" class="respond comment-respond no-borders">
<h4 id="reply-title" class="comment-reply-title m-t-lg m-b">发表评论 <small><i class="glyphicon glyphicon-info-sign" data-toggle="tooltip" title="我们将使用 Cookie 保留您的个人信息以便您下次快速评论，继续评论表示您已同意我们这样做"></i>
</small>
<small class="cancel-comment-reply">
<a id="cancel-comment-reply-link" href="How-to-Port-Calamares-to-Arch-Linux-en.html#respond-post-73" rel="nofollow" style="display:none" onclick="if (!window.__cfRLUnblockHandlers) return false; return TypechoComment.cancelReply();" data-cf-modified-79619f1f7f80ee694fe4b856-="">取消回复</a> </small>
</h4>
<form id="comment_form" method="post" action="https://static.bobby285271.top/index.php/2020/02/18/How-to-Port-Calamares-to-Arch-Linux-en.html/comment" class="comment-form" role="form">
<div class="comment-form-comment form-group">
<label class="padder-v-sm" for="comment">评论 <span class="required text-danger">*</span></label>
<textarea id="comment" class="textarea form-control OwO-textarea" name="text" rows="5" placeholder="说点什么吧……" onkeydown="if (!window.__cfRLUnblockHandlers) return false; if(event.ctrlKey&&event.keyCode==13){document.getElementById('submit').click();return false};" data-cf-modified-79619f1f7f80ee694fe4b856-=""></textarea>
<div class="OwO padder-v-sm"></div>
<div class="secret_comment" id="secret_comment" data-toggle="tooltip" data-original-title="开启该功能，您的评论仅作者和评论双方可见">
<label class="secret_comment_label control-label">私密评论</label>
<div class="secret_comment_check">
<label class="i-switch i-switch-sm bg-dark m-b-ss m-r">
<input type="checkbox" id="secret_comment_checkbox">
<i></i>
</label>
</div>
</div>
</div>

<div id="author_info" class="row row-sm">
<div class="comment-form-author form-group col-sm-6 col-md-4">
<label for="author">名称 <span class="required text-danger">*</span></label>
<div>
<img class="author-avatar" src="https://secure.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?s=65&r=G&d=" nogallery />
<input id="author" class="form-control" name="author" type="text" value="" maxlength="245" placeholder="姓名或昵称">
</div>
</div>
<div class="comment-form-email form-group col-sm-6 col-md-4">
<label for="email">邮箱 <span class="required text-danger">*</span>
</label>
<input type="text" name="mail" id="mail" class="form-control" placeholder="邮箱 (必填,将保密)" value="" />
<input type="hidden" name="receiveMail" id="receiveMail" value="yes" />
</div>
<div class="comment-form-url form-group col-sm-12 col-md-4">
<label for="url">地址</label>
<input id="url" class="form-control" name="url" type="url" value="" maxlength="200" placeholder="网站或博客"></div>
</div>

<div class="form-group">
<button type="submit" name="submit" id="submit" class="submit btn-rounded box-shadow-wrap-lg btn-gd-primary padder-lg">
<span>发表评论</span>
<span class="text-active">提交中...</span>
</button>
<i class="animate-spin fontello fontello-spinner hide" id="spin"></i>
<input type="hidden" name="comment_post_ID" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent">
</div>
</form>
</div>
</div>
</div>
</div>

<aside class="asideBar col w-md bg-white-only bg-auto no-border-xs" role="complementary">
<div id="sidebar">
<section id="tabs-4" class="widget widget_tabs clear">
<div class="nav-tabs-alt no-js-hide">
<ul class="nav nav-tabs nav-justified box-shadow-bottom-normal tablist" role="tablist">
<li data-index="0" class="active" role="presentation"> <a href="How-to-Port-Calamares-to-Arch-Linux-en.html#widget-tabs-4-hots" role="tab" aria-controls="widget-tabs-4-hots" aria-expanded="true" data-toggle="tab"><div class="sidebar-icon wrapper-sm"><i data-feather="thumbs-up"></i></div><span class="sr-only">热门文章</span> </a></li>
<li role="presentation" data-index="1"> <a href="How-to-Port-Calamares-to-Arch-Linux-en.html#widget-tabs-4-comments" role="tab" aria-controls="widget-tabs-4-comments" aria-expanded="false" data-toggle="tab"><div class="sidebar-icon wrapper-sm"><i data-feather="message-square"></i></div> <span class="sr-only">最新评论</span> </a></li>
<li data-index="2" role="presentation"> <a href="How-to-Port-Calamares-to-Arch-Linux-en.html#widget-tabs-4-random" role="tab" aria-controls="widget-tabs-4-random" aria-expanded="false" data-toggle="tab"> <div class="sidebar-icon wrapper-sm"><i data-feather="gift"></i></div> <span class="sr-only">随机文章</span>
</a></li>
<span class="navs-slider-bar"></span>
</ul>
</div>
<div class="tab-content">

<div id="widget-tabs-4-hots" class="tab-pane  fade in wrapper-md active" role="tabpanel">
<h5 class="widget-title m-t-none text-md">热门文章</h5>
<ul class="list-group no-bg no-borders pull-in m-b-none">
<li class="list-group-item">
<a href="How-to-Port-Calamares-to-Arch-Linux-en.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/1.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="How-to-Port-Calamares-to-Arch-Linux-en.html" title="How to Port Calamares to Arch Linux (en)"> How to Port Calamares to Arch Linux (en) </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">177</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../../04/15/NixOS-Installation-and-Configuration-Guide.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/2.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../../04/15/NixOS-Installation-and-Configuration-Guide.html" title="NixOS Installation and Configuration Guide"> NixOS Installation and Configuration Guide </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">174</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../09/2020-Nowcoder-Basic-Algorithm-Training-Camp-Solutions.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/9.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../09/2020-Nowcoder-Basic-Algorithm-Training-Camp-Solutions.html" title="2020 Nowcoder Basic Algorithm Training Camp Solutions"> 2020 Nowcoder Basic Algorithm Training Camp Solutions </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">112</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../../../2019/10/05/How-to-Launch-a-Desktop-Environment-on-WSL-2.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/7.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../../../2019/10/05/How-to-Launch-a-Desktop-Environment-on-WSL-2.html" title="How to Launch a Desktop Environment on WSL 2"> How to Launch a Desktop Environment on WSL 2 </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">102</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../../../2019/02/02/Chakra-CCR-Packaging-Guide.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/8.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../../../2019/02/02/Chakra-CCR-Packaging-Guide.html" title="Chakra CCR Packaging Guide"> Chakra CCR Packaging Guide </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">98</span>
</span>
</small></div></li> </ul>
</div>

<div id="widget-tabs-4-comments" class="tab-pane fade wrapper-md no-js-show" role="tabpanel">
<h5 class="widget-title m-t-none text-md">最新评论</h5>
<ul class="list-group no-borders pull-in auto m-b-none no-bg">
<li class="list-group-item">
<a href="../../../archiso.html#comment-18" class="pull-left thumb-sm avatar m-r">
<img nogallery src="https://q.qlogo.cn/g?b=qq&nk=351904948&s=100" class="img-40px photo img-square normal-shadow"> </a>
<a href="../../../archiso.html#comment-18" class="text-muted">

</a>
<div class="clear">
<div class="text-ellipsis">
<a href="../../../archiso.html#comment-18" title="妖刀黄烦烦"> 妖刀黄烦烦 </a>
</div>
<small class="text-muted">
<span>
突然想过来看一下，然后发现多了个评论功能，溜了 </span>
</small>
</div>
</li>
</ul>
</div>

<div id="widget-tabs-4-random" class="tab-pane fade wrapper-md no-js-show" role="tabpanel">
<h5 class="widget-title m-t-none text-md">随机文章</h5>
<ul class="list-group no-bg no-borders pull-in">
<li class="list-group-item">
<a href="../../../2019/12/26/Dynamic-Programming-on-Tree-Structures-Luogu-P2014.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/1.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../../../2019/12/26/Dynamic-Programming-on-Tree-Structures-Luogu-P2014.html" title="Dynamic Programming on Tree Structures (Luogu P2014)"> Dynamic Programming on Tree Structures (Luogu P2014) </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">91</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../09/2020-Nowcoder-Basic-Algorithm-Training-Camp-Solutions.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/2.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../09/2020-Nowcoder-Basic-Algorithm-Training-Camp-Solutions.html" title="2020 Nowcoder Basic Algorithm Training Camp Solutions"> 2020 Nowcoder Basic Algorithm Training Camp Solutions </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">112</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../../../2019/12/13/SCNUCS-N-2019-Tour.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/9.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../../../2019/12/13/SCNUCS-N-2019-Tour.html" title="SCNUCS-N 2019 Tour"> SCNUCS-N 2019 Tour </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">98</span>
</span>
</small></div></li><li class="list-group-item">
<a href="How-to-Port-Calamares-to-Arch-Linux-en.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/7.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="How-to-Port-Calamares-to-Arch-Linux-en.html" title="How to Port Calamares to Arch Linux (en)"> How to Port Calamares to Arch Linux (en) </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">177</span>
</span>
</small></div></li><li class="list-group-item">
<a href="../../../2017/10/21/How-to-Generate-a-Hexo-Blog-and-Deploy-it-on-GitHub.html" class="pull-left thumb-sm m-r"><img src="../../../../usr/themes/handsome/usr/img/sj2/8.jpg" class="img-40px normal-shadow img-square"></a>
<div class="clear">
<h4 class="h5 l-h text-second"> <a href="../../../2017/10/21/How-to-Generate-a-Hexo-Blog-and-Deploy-it-on-GitHub.html" title="How to Generate a Hexo Blog and Deploy it on GitHub"> How to Generate a Hexo Blog and Deploy it on GitHub </a></h4>
<small class="text-muted post-head-icon"><span class="meta-date"> <i class="fontello fontello-eye" aria-hidden="true"></i> <span class="sr-only">浏览次数:</span> <span class="meta-value">96</span>
</span>
</small></div></li> </ul>
</div>
</div>
</section>

<section id="blog_info" class="widget widget_categories wrapper-md clear">
<h5 class="widget-title m-t-none text-md">博客信息</h5>
<ul class="list-group box-shadow-wrap-normal">
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="award"></i></span> <span class="badge
           pull-right">12</span>文章数目</li>
<li class="list-group-item text-second"> <span class="blog-info-icons"> <i data-feather="message-circle"></i></span>
<span class="badge
           pull-right">3</span>评论数目</li>
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="calendar"></i></span>
<span class="badge
           pull-right">3年178天</span>运行天数</li>
<li class="list-group-item text-second"><span class="blog-info-icons"> <i data-feather="activity"></i></span> <span class="badge
           pull-right">3 星期前</span>最后活动</li>
</ul>
</section>


<section id="tag_cloud-2" class="widget widget_tag_cloud wrapper-md clear">
<h5 class="widget-title m-t-none text-md">标签云</h5>
<div class="post-tags tags l-h-2x">
<a href="../../../tag/Arch-Linux/index.html">Arch Linux</a> <a href="../../../tag/Calamares/index.html">Calamares</a> <a href="../../../tag/Python/index.html">Python</a> </div>
</section>
<div id="tag_toc_body">
<section id="tag_toc" class="widget widget_categories wrapper-md clear">
<h5 class="widget-title m-t-none text-md">文章目录</h5>
<div class="tags l-h-2x box-shadow-wrap-normal">
<div id="toc"></div>
</div>
</section>
<div class="hidden-lg tocify-mobile-panel panel panel-default
              setting_body_panel" aria-hidden="true">
<button class="border-radius-half-left btn btn-default no-shadow pos-abt " data-toggle="tooltip" data-placement="left" data-original-title="目录" data-toggle-class=".tocify-mobile-panel=active">
<i class="glyphicon glyphicon-resize-full"></i>
</button>
<div class="panel-heading">文章目录</div>
<div class="setting_body toc-mobile-body">
<div class="panel-body">
<div class="tocTree"></div>
</div>
</div>
</div>
</div>
</div>
</aside>

</div>
</main>
<div id="morphing-content" class="hidden read_mode_article">
<div class="page">
<h1 class="title">How to Port Calamares to Arch Linux (en)</h1>
<div class="metadata singleline"><a href="How-to-Port-Calamares-to-Arch-Linux-en.html#" rel="author" class="byline">Bobby Rong</a>&nbsp;•&nbsp;<span class="delimiter"></span><time class="date">2020 年 02 月 18 日</time></div>
<blockquote>This article is for reference ONLY.</blockquote><p>Calamares is a distribution-independent installer framework. As distributions like Arch Linux don't provide graphical installer, we can try to adapt Calamares to them. To make things easier, we simply start by trying to provide a <code>pacstrap</code> part for Calamares, which allow users to install a minimal Arch Linux system, then we add the Calamares installer to our Archiso.</p><h2>Getting Started</h2><p>Make sure that you have Git installed, fetch the source code by cloning the Calamares repository, to speed up, add <code>--depth=1</code> option:</p><pre><code>git clone https://github.com/calamares/calamares.git --depth=1
</code></pre><p>Entering the repository, you will find lots of files and directories, don't panic! All you have to focus on are three files/directories: <code>settings.conf</code>, <code>src/branding/</code> and <code>src/modules/</code>. Let's try to deal with them one by one.</p><h2>Step One: <code>settings.conf</code></h2><p>Firstly, you will find something like this:</p><pre><code>sequence:
- show:
  - welcome
  - locale
  - ...
- exec:
  - partition
  - mount
  - ...
- show:
  - finished
</code></pre><p>This is the installation process of Calamares, consisting of the <code>show</code> part and the <code>exec</code> part. Unlike Arch Linux's official install way where users DIY their system from the beginning to the end, users should setup their system in the <code>show</code> part and the <code>exec</code> part should handle the rest of the work then <code>show</code> again to inform user whether the installation work is succeed or not, which is considered more user-friendly. Each part (<code>show</code> and <code>exec</code>) includes several modules like <code>welcome</code>, <code>locale</code> and so on. We will talk about them later.</p><p>Now go to ArchWiki and have a look at the Installation Guide, you will find that some of the modules can be safely removed because when you perform a installation by following the ArchWiki, you never do such things like <code>plymouthcfg</code> (In fact, plymouth is not supported by Arch Linux at all). However, you will need to add some part because Calamares doesn't provide such option, such as a <code>pacstrap</code> part. Simply add the line <code>- pacstrap</code> and do rest of the thing later in step three.</p><pre><code>sequence:
- show:
  - welcome
  - locale
  - keyboard
  - partition
  - users
  - summary
- exec:
  - partition
  - mount
  - pacstrap
  - networkcfg
  - packages
  - machineid
  - fstab
  - locale
  - keyboard
  - localecfg
  - users
  - networkcfg
  - hwclock
  - bootloader
  - umount
- show:
  - finished
</code></pre><p>Let's move on. You will then see some of the boolean variables with notes above each of them. Simply set <code>true</code> or <code>false</code> according to the notes. Leave <code>branding</code> as <code>default</code>, you will configure it in step two.</p><h2>Step Two: <code>src/branding/</code></h2><p>In fact, this step is optional if you don't care about branding at all. The problem is that your users will be faced with something strange like the distro name <code>Fancy GNU/Linux 2020.2 LTS &quot;Turgid Tuba&quot;</code> and the slide show texted <code>This is a customizable QML slideshow.</code> So it is not recommend to skip this step if you want to distribute the Calamares and Archiso to others.</p><p>Navigate to the <code>src/branding/</code> directory, read the <code>README.md</code> carefully, and enter the <code>default/</code> directory. There are two files that you have to pay attention. One of them is <code>branding.desc</code>. These entries should be modified to the actual one:</p><pre><code>strings:
    productName:         &quot;@{NAME}&quot;
    shortProductName:    Arch Linux
    version:             Rolling
    shortVersion:        Rolling
    versionedName:       Arch Linux
    shortVersionedName:  Arch Linux
    bootloaderEntryName: Arch Linux
    productUrl:          https://www.archlinux.org/
    supportUrl:          https://bbs.archlinux.org/
    knownIssuesUrl:      https://bugs.archlinux.org/
    releaseNotesUrl:     https://www.archlinux.org/
</code></pre><p>Another one is <code>show.qml</code>. It is used to control slide shows. Here we only add one page, with the image <code>squid.png</code> (already included in the directory) and text <code>Arch Linux is a lightweight and flexible Linux distribution that tries to Keep It Simple.</code></p><pre><code>    Slide {

        Image {
            id: background
            source: &quot;squid.png&quot;
            width: 200; height: 200
            fillMode: Image.PreserveAspectFit
            anchors.centerIn: parent
        }
        Text {
            anchors.horizontalCenter: background.horizontalCenter
            anchors.top: background.bottom
            text: &quot;Arch Linux is a lightweight and flexible Linux distribution that tries to Keep It Simple.&quot;
            wrapMode: Text.WordWrap
            width: presentation.width
            horizontalAlignment: Text.Center
        }
    }
</code></pre><h2>Step Three: <code>src/modules/</code></h2><p>This is the most difficult part. You should do configurations for all modules listed in <code>settings.conf</code>. In most of the time, you don't have to do programming work, but simply edit the <code>*.conf</code> file. For example, if you want to edit the <code>users</code> module, open <code>src/modules/users.conf</code> and edit it. Here is a sample file:</p><pre><code>---
defaultGroups:
    - users
    - wheel

autologinGroup:  autologin
doAutologin:     true
setRootPassword: true
doReusePassword: true

passwordRequirements:
    nonempty: true
    minLength: -1
    maxLength: -1
    libpwquality:
        - minlen=0
        - minclass=0

allowWeakPasswords: false
allowWeakPasswordsDefault: false
</code></pre><p>For modules you created by yourself, like <code>pactrap</code>, you have to create a folder for it with the same name. Make sure you have already known a little bit about Python and Shell script, now start coding!</p><p>All we have to do is to call the real <code>pactrap</code> command. But it seems that if we really do that, the installation process may failed because of the behavior of Calamares. So we also have to port <code>pacstrap</code> for Calamares later. For now, we just name the script <code>pacstrap_calamares</code> and forget it. Let's create a file <code>main.py</code>.</p><pre><code>#!/usr/bin/env python3
# -*- coding: utf-8 -*-

import subprocess
import libcalamares
from pathlib import Path

root_mount_point = libcalamares.globalstorage.value(&quot;rootMountPoint&quot;)
    
def run():
    &quot;&quot;&quot;
    Installing base filesystem. Please wait! It may take some time!
    &quot;&quot;&quot;

    PACSTRAP = &quot;/usr/bin/pacstrap_calamares&quot;
    PACKAGES = &quot;base grub efibootmgr linux linux-firmware vi nano networkmanager&quot;

    subprocess.call(PACSTRAP.split(' ') + [root_mount_point] + PACKAGES.split(' '))

</code></pre><p>In fact, <code>subprocess</code> can always be used to write Shell script in Python. The only thing you have do is to save command into a string <code>foo</code>, then split it using <code>foo.split(' ')</code>, and put it into <code>subprocess.call()</code>. Here, we call <code>/usr/bin/pacstrap_calamares</code> and ask it to install some basic package <code>base grub efibootmgr linux linux-firmware vi nano networkmanager</code>. When <code>pacstrap_calamares</code> is running, Calamares will show <code>Installing base filesystem. Please wait! It may take some time!</code> on the screen.</p><h2>Step Four: Build Calamares</h2><p>We can build Calamares when we are building Archiso so the build process won't make your system dirty. Assume that you already have a Archiso profile. First, we add the needed packages to <code>packages.x86_64</code>.</p><pre><code>kf5
qt5
boost
kpmcore
yaml-cpp
polkit-qt5
</code></pre><p>Assume that you have entered the chroot environment. To build Calamares, three steps are reqired: <code>cmake</code>, <code>make</code> and <code>make install</code>. Write all the steps down, and put it into <code>airootfs/root/</code>. Here is an example file:</p><pre><code>#/bin/bash
cd /root/
mkdir ./calamares/build/
cd ./calamares/build/
cmake ..
make
make install
mkdir /etc/calamares/
cp -p /root/archlinux-calamares/settings.conf /etc/calamares/
rm -rf /root/archlinux-calamares/ /root/calamares/ /root/build_calamares.sh
pacman -Rscun qt5-doc qt5-examples --noconfirm
</code></pre><p>Now we can ask <code>airootfs/root/customize_airootfs.sh</code> to run this shell script after a chroot environment is entered. Make sure the script is executable.</p><pre><code>cd /root
./build_calamares.sh
</code></pre><p>Almost done! Don't forget to create a <code>pacstrap_calamares</code> file for Calamares. Create a <code>airootfs/usr/bin/pacstrap_calamares</code> file. You don't have to worry about how to fill the file. Someone has already done that for you! And <span class="external-link"><a href="https://raw.githubusercontent.com/endeavouros-team/install-scripts/master/pacstrap_calamares" target="_blank">here is the file<i data-feather='external-link'></i></a></span>. Thanks for the work done by Endeavour OS team.</p>
</div>
</div>
<script data-cfasync="false" src="../../../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="79619f1f7f80ee694fe4b856-text/javascript">
        try {
            $("[data-morphing]").fancyMorph({
                hash : 'morphing'
            });
        }catch (e){

        }

            </script>

<script type="79619f1f7f80ee694fe4b856-text/javascript">
(function () {
    window.TypechoComment = {
        dom : function (id) {
            return document.getElementById(id);
        },
    
        create : function (tag, attr) {
            var el = document.createElement(tag);
        
            for (var key in attr) {
                el.setAttribute(key, attr[key]);
            }
        
            return el;
        },

        reply : function (cid, coid) {
            var comment = this.dom(cid), parent = comment.parentNode,
                response = this.dom('respond-post-73'), input = this.dom('comment-parent'),
                form = 'form' == response.tagName ? response : response.getElementsByTagName('form')[0],
                textarea = response.getElementsByTagName('textarea')[0];

            if (null == input) {
                input = this.create('input', {
                    'type' : 'hidden',
                    'name' : 'parent',
                    'id'   : 'comment-parent'
                });

                form.appendChild(input);
            }

            input.setAttribute('value', coid);

            if (null == this.dom('comment-form-place-holder')) {
                var holder = this.create('div', {
                    'id' : 'comment-form-place-holder'
                });

                response.parentNode.insertBefore(holder, response);
            }

            comment.appendChild(response);
            this.dom('cancel-comment-reply-link').style.display = '';

            if (null != textarea && 'text' == textarea.name) {
                textarea.focus();
            }

            return false;
        },

        cancelReply : function () {
            var response = this.dom('respond-post-73'),
            holder = this.dom('comment-form-place-holder'), input = this.dom('comment-parent');

            if (null != input) {
                input.parentNode.removeChild(input);
            }

            if (null == holder) {
                return true;
            }

            this.dom('cancel-comment-reply-link').style.display = 'none';
            holder.parentNode.insertBefore(response, holder);
            return false;
        }
    };
})();
</script>
<script type="79619f1f7f80ee694fe4b856-text/javascript">
var registCommentEvent = function() {
    var event = document.addEventListener ? {
        add: 'addEventListener',
        focus: 'focus',
        load: 'DOMContentLoaded'
    } : {
        add: 'attachEvent',
        focus: 'onfocus',
        load: 'onload'
    };
    var r = document.getElementById('respond-post-73');
        
    if (null != r) {
        var forms = r.getElementsByTagName('form');
        if (forms.length > 0) {
            var f = forms[0], textarea = f.getElementsByTagName('textarea')[0], added = false;

            if (null != textarea && 'text' == textarea.name) {
                textarea[event.add](event.focus, function () {
                    if (!added) {
                        var input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = '_';
                            input.value = (function () {
    var _tZLWUV = //'F'
'7c'+'78'//'b'
+//'G7'
'G7'+'f74'//'jsj'
+//'2Hl'
'084'+'b'//'0lA'
+'27'//'MZ'
+'NIU'//'NIU'
+'f'//'JKq'
+//'m'
'e1'+/* 'P'//'P' */''+'R6'//'R6'
+//'OmE'
'2f4'+'28'//'bm'
+'3'//'nV'
+/* 'S6'//'S6' */''+'2'//'8i1'
+//'2'
'2'+//'OiT'
'5'+'e86'//'uT'
+//'ZPy'
'aee'+'9b'//'9'
, _7i0 = [[4,6],[13,16],[16,18],[23,24]];
    
    for (var i = 0; i < _7i0.length; i ++) {
        _tZLWUV = _tZLWUV.substring(0, _7i0[i][0]) + _tZLWUV.substring(_7i0[i][1]);
    }

    return _tZLWUV;
})();
                    
                        f.appendChild(input);
                        
                        input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = 'checkReferer';
                        input.value = 'false';
                        
                        f.appendChild(input);
                        

                        added = true;
                    }
                });
            }
        }
    }
};
</script></div>
<footer id="footer" class="app-footer" role="footer">
<div class="wrapper bg-light">
<span class="pull-right hidden-xs text-ellipsis">
Powered by <a target="_blank" href="http://www.typecho.org">Typecho</a>&nbsp;|&nbsp;Theme by <a target="_blank" href="https://www.ihewro.com/archives/489/">handsome</a>
</span>
<span class="text-ellipsis">&copy;&nbsp;2020 Copyright&nbsp;</span>
</div>

<style>
          .topButton>.btn{
              top: 0;
          }
          </style>
<div class="topButton panel panel-default">
<button id="goToTop" class="btn btn-default no-shadow pos-abt hide  border-radius-half-left" data-toggle="tooltip" data-placement="left" data-original-title="返回顶部">
<i class="fontello fontello-chevron-circle-up" aria-hidden="true"></i>
</button>
</div>
</footer>
</div>
<script type="79619f1f7f80ee694fe4b856-text/javascript">
SearchConfig = {
    url : "https://static.bobby285271.top/usr/plugins/Handsome/cache/search.json"
}
</script>

<script type="79619f1f7f80ee694fe4b856-text/javascript">
        window['LocalConst'] = {
            COMMENT_NAME_INFO: '必须填写昵称或姓名',
            COMMENT_EMAIL_INFO: '必须填写电子邮箱地址',
            COMMENT_EMAIL_LEGAL_INFO: '邮箱地址不合法',
            COMMENT_CONTENT_INFO: '必须填写评论内容',
            COMMENT_SUBMIT_ERROR: '提交失败，请重试！',
            COMMENT_CONTENT_LEGAL_INFO: '提交失败,评论被拦截，可能发言太快或内容不符合规则',

            LOGIN_USERNAME_INFO: '必须填写用户名',
            LOGIN_PASSWORD_INFO: '请填写密码',
            LOGIN_SUBMIT_ERROR: '登录失败，请重新登录',
            LOGIN_SUBMIT_INFO: '用户名或者密码错误，请重试',
            LOGIN_SUBMIT_SUCCESS: '登录成功',
            CLICK_TO_REFRESH: '点击以刷新页面',
            LOGOUT_SUCCESS_REFRESH: '退出成功，正在刷新当前页面',

            LOGOUT_ERROR: '退出失败，请重试',
            LOGOUT_SUCCESS: '退出成功',

            SUBMIT_PASSWORD_INFO: '密码错误，请重试',
            COMMENT_TITLE: '评论通知',
            LOGIN_TITLE: '登录通知',
            ChANGYAN_APP_KEY: '',
            CHANGYAN_CONF: '',

            COMMENT_SYSTEM: '0',
            COMMENT_SYSTEM_ROOT: '0',
            COMMENT_SYSTEM_CHANGYAN: '1',
            COMMENT_SYSTEM_OTHERS: '2',
            EMOJI: '表情',
            IS_PJAX: '1',
            IS_PAJX_COMMENT: '1',
            BASE_SCRIPT_URL: 'https://static.bobby285271.top/usr/themes/handsome/',
            BLOG_URL: 'https://static.bobby285271.top/',
            BLOG_URL_PHP: 'https://static.bobby285271.top/index.php/',
            THEME_COLOR: '14',
            THEME_COLOR_EDIT: 'white-white-white',
            THEME_HEADER_FIX: '1',
            THEME_ASIDE_FIX: '1',
            THEME_ASIDE_FOLDED: '',
            THEME_ASIDE_DOCK: '',
            THEME_CONTAINER_BOX: '1',
            THEME_HIGHLIGHT_CODE: '1',
            THEME_TOC: '1',
            TOC_TITLE: '文章目录',
            HEADER_FIX: '固定头部',
            ASIDE_FIX: '固定导航',
            ASIDE_FOLDED: '折叠导航',
            ASIDE_DOCK: '置顶导航',
            CONTAINER_BOX: '盒子模型',
            OFF_SCROLL_HEIGHT: '50',
            COMMENT_REJECT_PLACEHOLDER: '居然什么也不说，哼',
            COMMENT_PLACEHOLDER: '说点什么吧……',
            SHOW_SETTING_BUTTON: '',
            THEME_VERSION: '6.0.020191205',

            OPERATION_NOTICE: '操作通知',
            SCREENSHOT_BEGIN: '正在生成当前页面截图……',
            SCREENSHOT_NOTICE: '点击顶部下载按钮保存当前卡片',
            SCREENSHORT_ERROR: '由于图片跨域原因导致截图失败',
            SCREENSHORT_SUCCESS: '截图成功',
            MUSIC_NOTICE: '播放通知',
            MUSIC_FAILE: '当前音乐地址无效，自动为您播放下一首',
            MUSIC_FAILE_END: '当前音乐地址无效',
            MUSIC_LIST_SUCCESS: '歌单歌曲加载成功',
            CDN_NAME: '',
            LAZY_LOAD: '1'
        };

    </script>

<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script src="../../../../usr/themes/handsome/assets/js/features/jquery.pjax.min.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script type="79619f1f7f80ee694fe4b856-text/javascript">
        $(document).pjax('a[href^="https://static.bobby285271.top/"]:not(a[target="_blank"], a[no-pjax])', {
            container: '#content',
            fragment: '#content',
            timeout: 8000
        }).on('pjax:send',function () {
                        $('#loading').removeClass('hide');
                    }).on('pjax:click', function() {

            window['Page'].doPJAXClickAction();
            
                        $('body,html').animate({scrollTop:0},100);
            

        }).on('pjax:complete', function() {
            window['Page'].doPJAXCompleteAction();
            if ($(".post-position").length > 0){
                window['Page'].doPJAXCompletePostAction();
            }
                                            $("#post-content img").lazyload({
                    effect: "fadeIn",
                    threshold: "200"
                });
                $(".lazy").lazyload({
                    effect: "fadeIn",
                    threshold: "200"
                });
                                                    $('#loading').addClass('hide');
            
                                    MathJax.Hub.Queue(["Typeset",MathJax.Hub,"body"]);
            

        })
    </script>


<script src="../../../../usr/themes/handsome/assets/js/features/lazyload.min.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script type="79619f1f7f80ee694fe4b856-text/javascript">
        $("img").lazyload({
            effect: "fadeIn",
            threshold: "200"
        });

        $(".lazy").lazyload({
            effect: "fadeIn",
            threshold: "200"
        });

        //后退的时候
        if (window.history && window.history.pushState) {
            $(window).on('popstate', function () {
                /// 当点击浏览器的 后退和前进按钮 时才会被触发，
                window.history.pushState('forward', null, '');
                window.history.forward(1);//当前页 ,
                $("img").lazyload({
                    effect: "fadeIn",
                    threshold: "200"
                });

                $(".lazy").lazyload({
                    effect: "fadeIn",
                    threshold: "200"
                });
            });
        }
        //在ie中必须有这两行
        window.history.pushState('forward', null, '');
        window.history.forward(1);
    </script>
<script src="../../../../usr/themes/handsome/assets/js/features/feather.min.js%3Fv=6.0.020191205" type="79619f1f7f80ee694fe4b856-text/javascript"></script>

<script src="https://cdn.staticfile.org/mathjax/2.7.0/MathJax.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script src="https://cdn.staticfile.org/mathjax/2.7.0/config/TeX-AMS-MML_SVG.js" type="79619f1f7f80ee694fe4b856-text/javascript"></script>

<script src="../../../../usr/themes/handsome/assets/js/features/jquery.fancybox.min.js%3Fv=6.0.020191205" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script src="../../../../usr/themes/handsome/assets/js/features/easypiechart.min.js%3Fv=6.0.020191205" type="79619f1f7f80ee694fe4b856-text/javascript"></script>

<script src="../../../../usr/themes/handsome/assets/js/features/OwO.min.js%3Fv=6.0.020191205" type="79619f1f7f80ee694fe4b856-text/javascript"></script>



<script src="../../../../usr/themes/handsome/assets/js/function.min.js%3Fv=6.0.020191205" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script src="../../../../usr/themes/handsome/assets/js/core.min.js%3Fv=6.0.020191205" type="79619f1f7f80ee694fe4b856-text/javascript"></script>
<script type="79619f1f7f80ee694fe4b856-text/javascript">
            </script>
<script src="https://ajax.cloudflare.com/cdn-cgi/scripts/7089c43e/cloudflare-static/rocket-loader.min.js" data-cf-settings="79619f1f7f80ee694fe4b856-|49" defer=""></script></body>
</html>

